"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[330],{9365:function(a,b,c){c.d(b,{z:function(){return h}});var d=c(9477);let e={type:"change"},f={type:"start"},g={type:"end"};class h extends d.pBf{constructor(a,b){super(),void 0===b&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),b===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=a,this.domElement=b,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new d.Pa4,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:d.RsA.ROTATE,MIDDLE:d.RsA.DOLLY,RIGHT:d.RsA.PAN},this.touches={ONE:d.QmN.ROTATE,TWO:d.QmN.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return k.phi},this.getAzimuthalAngle=function(){return k.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(a){a.addEventListener("keydown",Y),this._domElementKeyEvents=a},this.saveState=function(){c.target0.copy(c.target),c.position0.copy(c.object.position),c.zoom0=c.object.zoom},this.reset=function(){c.target.copy(c.target0),c.object.position.copy(c.position0),c.object.zoom=c.zoom0,c.object.updateProjectionMatrix(),c.dispatchEvent(e),c.update(),i=h.NONE},this.update=function(){let b=new d.Pa4,f=new d._fP().setFromUnitVectors(a.up,new d.Pa4(0,1,0)),g=f.clone().invert(),p=new d.Pa4,q=new d._fP,r=2*Math.PI;return function(){let a=c.object.position;b.copy(a).sub(c.target),b.applyQuaternion(f),k.setFromVector3(b),c.autoRotate&&i===h.NONE&&C(A()),c.enableDamping?(k.theta+=l.theta*c.dampingFactor,k.phi+=l.phi*c.dampingFactor):(k.theta+=l.theta,k.phi+=l.phi);let d=c.minAzimuthAngle,s=c.maxAzimuthAngle;return isFinite(d)&&isFinite(s)&&(d< -Math.PI?d+=r:d>Math.PI&&(d-=r),s< -Math.PI?s+=r:s>Math.PI&&(s-=r),d<=s?k.theta=Math.max(d,Math.min(s,k.theta)):k.theta=k.theta>(d+s)/2?Math.max(d,k.theta):Math.min(s,k.theta)),k.phi=Math.max(c.minPolarAngle,Math.min(c.maxPolarAngle,k.phi)),k.makeSafe(),k.radius*=m,k.radius=Math.max(c.minDistance,Math.min(c.maxDistance,k.radius)),!0===c.enableDamping?c.target.addScaledVector(n,c.dampingFactor):c.target.add(n),b.setFromSpherical(k),b.applyQuaternion(g),a.copy(c.target).add(b),c.object.lookAt(c.target),!0===c.enableDamping?(l.theta*=1-c.dampingFactor,l.phi*=1-c.dampingFactor,n.multiplyScalar(1-c.dampingFactor)):(l.set(0,0,0),n.set(0,0,0)),m=1,!!(o||p.distanceToSquared(c.object.position)>j||8*(1-q.dot(c.object.quaternion))>j)&&(c.dispatchEvent(e),p.copy(c.object.position),q.copy(c.object.quaternion),o=!1,!0)}}(),this.dispose=function(){c.domElement.removeEventListener("contextmenu",_),c.domElement.removeEventListener("pointerdown",R),c.domElement.removeEventListener("pointercancel",U),c.domElement.removeEventListener("wheel",X),c.domElement.removeEventListener("pointermove",S),c.domElement.removeEventListener("pointerup",T),null!==c._domElementKeyEvents&&c._domElementKeyEvents.removeEventListener("keydown",Y)};let c=this,h={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},i=h.NONE,j=1e-6,k=new d.$V,l=new d.$V,m=1,n=new d.Pa4,o=!1,p=new d.FM8,q=new d.FM8,r=new d.FM8,s=new d.FM8,t=new d.FM8,u=new d.FM8,v=new d.FM8,w=new d.FM8,x=new d.FM8,y=[],z={};function A(){return 2*Math.PI/60/60*c.autoRotateSpeed}function B(){return Math.pow(.95,c.zoomSpeed)}function C(a){l.theta-=a}function D(a){l.phi-=a}let E=function(){let a=new d.Pa4;return function(b,c){a.setFromMatrixColumn(c,0),a.multiplyScalar(-b),n.add(a)}}(),F=function(){let a=new d.Pa4;return function(b,d){!0===c.screenSpacePanning?a.setFromMatrixColumn(d,1):(a.setFromMatrixColumn(d,0),a.crossVectors(c.object.up,a)),a.multiplyScalar(b),n.add(a)}}(),G=function(){let a=new d.Pa4;return function(b,d){let e=c.domElement;if(c.object.isPerspectiveCamera){let f=c.object.position;a.copy(f).sub(c.target);let g=a.length();E(2*b*(g*=Math.tan(c.object.fov/2*Math.PI/180))/e.clientHeight,c.object.matrix),F(2*d*g/e.clientHeight,c.object.matrix)}else c.object.isOrthographicCamera?(E(b*(c.object.right-c.object.left)/c.object.zoom/e.clientWidth,c.object.matrix),F(d*(c.object.top-c.object.bottom)/c.object.zoom/e.clientHeight,c.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),c.enablePan=!1)}}();function H(a){c.object.isPerspectiveCamera?m/=a:c.object.isOrthographicCamera?(c.object.zoom=Math.max(c.minZoom,Math.min(c.maxZoom,c.object.zoom*a)),c.object.updateProjectionMatrix(),o=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),c.enableZoom=!1)}function I(a){c.object.isPerspectiveCamera?m*=a:c.object.isOrthographicCamera?(c.object.zoom=Math.max(c.minZoom,Math.min(c.maxZoom,c.object.zoom/a)),c.object.updateProjectionMatrix(),o=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),c.enableZoom=!1)}function J(a){p.set(a.clientX,a.clientY)}function K(a){s.set(a.clientX,a.clientY)}function L(){if(1===y.length)p.set(y[0].pageX,y[0].pageY);else{let a=.5*(y[0].pageX+y[1].pageX),b=.5*(y[0].pageY+y[1].pageY);p.set(a,b)}}function M(){if(1===y.length)s.set(y[0].pageX,y[0].pageY);else{let a=.5*(y[0].pageX+y[1].pageX),b=.5*(y[0].pageY+y[1].pageY);s.set(a,b)}}function N(){let a=y[0].pageX-y[1].pageX,b=y[0].pageY-y[1].pageY;v.set(0,Math.sqrt(a*a+b*b))}function O(a){if(1==y.length)q.set(a.pageX,a.pageY);else{let b=ad(a),d=.5*(a.pageX+b.x),e=.5*(a.pageY+b.y);q.set(d,e)}r.subVectors(q,p).multiplyScalar(c.rotateSpeed);let f=c.domElement;C(2*Math.PI*r.x/f.clientHeight),D(2*Math.PI*r.y/f.clientHeight),p.copy(q)}function P(a){if(1===y.length)t.set(a.pageX,a.pageY);else{let b=ad(a),d=.5*(a.pageX+b.x),e=.5*(a.pageY+b.y);t.set(d,e)}u.subVectors(t,s).multiplyScalar(c.panSpeed),G(u.x,u.y),s.copy(t)}function Q(a){let b=ad(a),d=a.pageX-b.x,e=a.pageY-b.y;w.set(0,Math.sqrt(d*d+e*e)),x.set(0,Math.pow(w.y/v.y,c.zoomSpeed)),H(x.y),v.copy(w)}function R(a){!1!==c.enabled&&(0===y.length&&(c.domElement.setPointerCapture(a.pointerId),c.domElement.addEventListener("pointermove",S),c.domElement.addEventListener("pointerup",T)),aa(a),"touch"===a.pointerType?Z(a):V(a))}function S(a){!1!==c.enabled&&("touch"===a.pointerType?$(a):W(a))}function T(a){ab(a),0===y.length&&(c.domElement.releasePointerCapture(a.pointerId),c.domElement.removeEventListener("pointermove",S),c.domElement.removeEventListener("pointerup",T)),c.dispatchEvent(g),i=h.NONE}function U(a){ab(a)}function V(a){let b;switch(a.button){case 0:b=c.mouseButtons.LEFT;break;case 1:b=c.mouseButtons.MIDDLE;break;case 2:b=c.mouseButtons.RIGHT;break;default:b=-1}switch(b){case d.RsA.DOLLY:var e;if(!1===c.enableZoom)return;e=a,v.set(e.clientX,e.clientY),i=h.DOLLY;break;case d.RsA.ROTATE:if(a.ctrlKey||a.metaKey||a.shiftKey){if(!1===c.enablePan)return;K(a),i=h.PAN}else{if(!1===c.enableRotate)return;J(a),i=h.ROTATE}break;case d.RsA.PAN:if(a.ctrlKey||a.metaKey||a.shiftKey){if(!1===c.enableRotate)return;J(a),i=h.ROTATE}else{if(!1===c.enablePan)return;K(a),i=h.PAN}break;default:i=h.NONE}i!==h.NONE&&c.dispatchEvent(f)}function W(a){var b,d;if(!1!==c.enabled)switch(i){case h.ROTATE:if(!1===c.enableRotate)return;!function(a){q.set(a.clientX,a.clientY),r.subVectors(q,p).multiplyScalar(c.rotateSpeed);let b=c.domElement;C(2*Math.PI*r.x/b.clientHeight),D(2*Math.PI*r.y/b.clientHeight),p.copy(q),c.update()}(a);break;case h.DOLLY:if(!1===c.enableZoom)return;b=a,w.set(b.clientX,b.clientY),x.subVectors(w,v),x.y>0?H(B()):x.y<0&&I(B()),v.copy(w),c.update();break;case h.PAN:if(!1===c.enablePan)return;d=a,t.set(d.clientX,d.clientY),u.subVectors(t,s).multiplyScalar(c.panSpeed),G(u.x,u.y),s.copy(t),c.update()}}function X(a){if(!1!==c.enabled&& !1!==c.enableZoom&&i===h.NONE){var b;a.preventDefault(),c.dispatchEvent(f),(b=a).deltaY<0?I(B()):b.deltaY>0&&H(B()),c.update(),c.dispatchEvent(g)}}function Y(a){!1!==c.enabled&& !1!==c.enablePan&&function(a){let b=!1;switch(a.code){case c.keys.UP:G(0,c.keyPanSpeed),b=!0;break;case c.keys.BOTTOM:G(0,-c.keyPanSpeed),b=!0;break;case c.keys.LEFT:G(c.keyPanSpeed,0),b=!0;break;case c.keys.RIGHT:G(-c.keyPanSpeed,0),b=!0}b&&(a.preventDefault(),c.update())}(a)}function Z(a){switch(ac(a),y.length){case 1:switch(c.touches.ONE){case d.QmN.ROTATE:if(!1===c.enableRotate)return;L(),i=h.TOUCH_ROTATE;break;case d.QmN.PAN:if(!1===c.enablePan)return;M(),i=h.TOUCH_PAN;break;default:i=h.NONE}break;case 2:switch(c.touches.TWO){case d.QmN.DOLLY_PAN:if(!1===c.enableZoom&& !1===c.enablePan)return;c.enableZoom&&N(),c.enablePan&&M(),i=h.TOUCH_DOLLY_PAN;break;case d.QmN.DOLLY_ROTATE:if(!1===c.enableZoom&& !1===c.enableRotate)return;c.enableZoom&&N(),c.enableRotate&&L(),i=h.TOUCH_DOLLY_ROTATE;break;default:i=h.NONE}break;default:i=h.NONE}i!==h.NONE&&c.dispatchEvent(f)}function $(a){var b,d;switch(ac(a),i){case h.TOUCH_ROTATE:if(!1===c.enableRotate)return;O(a),c.update();break;case h.TOUCH_PAN:if(!1===c.enablePan)return;P(a),c.update();break;case h.TOUCH_DOLLY_PAN:if(!1===c.enableZoom&& !1===c.enablePan)return;b=a,c.enableZoom&&Q(b),c.enablePan&&P(b),c.update();break;case h.TOUCH_DOLLY_ROTATE:if(!1===c.enableZoom&& !1===c.enableRotate)return;d=a,c.enableZoom&&Q(d),c.enableRotate&&O(d),c.update();break;default:i=h.NONE}}function _(a){!1!==c.enabled&&a.preventDefault()}function aa(a){y.push(a)}function ab(a){delete z[a.pointerId];for(let b=0;b<y.length;b++)if(y[b].pointerId==a.pointerId){y.splice(b,1);return}}function ac(a){let b=z[a.pointerId];void 0===b&&(b=new d.FM8,z[a.pointerId]=b),b.set(a.pageX,a.pageY)}function ad(a){let b=a.pointerId===y[0].pointerId?y[1]:y[0];return z[b.pointerId]}c.domElement.addEventListener("contextmenu",_),c.domElement.addEventListener("pointerdown",R),c.domElement.addEventListener("pointercancel",U),c.domElement.addEventListener("wheel",X,{passive:!1}),this.update()}}},1217:function(a,b,c){c.d(b,{E:function(){return e}});var d=c(9477);class e extends d.aNw{constructor(a){super(a),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(a){return new i(a)}),this.register(function(a){return new o(a)}),this.register(function(a){return new p(a)}),this.register(function(a){return new j(a)}),this.register(function(a){return new k(a)}),this.register(function(a){return new l(a)}),this.register(function(a){return new m(a)}),this.register(function(a){return new n(a)}),this.register(function(a){return new g(a)}),this.register(function(a){return new q(a)})}load(a,b,c,e){let f=this,g;g=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:d.Zp0.extractUrlBase(a),this.manager.itemStart(a);let h=function(b){e?e(b):console.error(b),f.manager.itemError(a),f.manager.itemEnd(a)},i=new d.hH6(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(a,function(c){try{f.parse(c,g,function(c){b(c),f.manager.itemEnd(a)},h)}catch(d){h(d)}},c,h)}setDRACOLoader(a){return this.dracoLoader=a,this}setDDSLoader(){throw Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(a){return this.ktx2Loader=a,this}setMeshoptDecoder(a){return this.meshoptDecoder=a,this}register(a){return -1===this.pluginCallbacks.indexOf(a)&&this.pluginCallbacks.push(a),this}unregister(a){return -1!==this.pluginCallbacks.indexOf(a)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(a),1),this}parse(a,b,c,e){let g,i={},j={};if("string"==typeof a)g=a;else{let k=d.Zp0.decodeText(new Uint8Array(a,0,4));if(k===r){try{i[f.KHR_BINARY_GLTF]=new u(a)}catch(l){e&&e(l);return}g=i[f.KHR_BINARY_GLTF].content}else g=d.Zp0.decodeText(new Uint8Array(a))}let m=JSON.parse(g);if(void 0===m.asset||m.asset.version[0]<2){e&&e(Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}let n=new T(m,{path:b||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});n.fileLoader.setRequestHeader(this.requestHeader);for(let o=0;o<this.pluginCallbacks.length;o++){let p=this.pluginCallbacks[o](n);j[p.name]=p,i[p.name]=!0}if(m.extensionsUsed)for(let q=0;q<m.extensionsUsed.length;++q){let s=m.extensionsUsed[q],t=m.extensionsRequired||[];switch(s){case f.KHR_MATERIALS_UNLIT:i[s]=new h;break;case f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:i[s]=new y;break;case f.KHR_DRACO_MESH_COMPRESSION:i[s]=new v(m,this.dracoLoader);break;case f.KHR_TEXTURE_TRANSFORM:i[s]=new w;break;case f.KHR_MESH_QUANTIZATION:i[s]=new z;break;default:t.indexOf(s)>=0&& void 0===j[s]&&console.warn('THREE.GLTFLoader: Unknown extension "'+s+'".')}}n.setExtensions(i),n.setPlugins(j),n.parse(c,e)}parseAsync(a,b){let c=this;return new Promise(function(d,e){c.parse(a,b,d,e)})}}let f={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class g{constructor(a){this.parser=a,this.name=f.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){let a=this.parser,b=this.parser.json.nodes||[];for(let c=0,d=b.length;c<d;c++){let e=b[c];e.extensions&&e.extensions[this.name]&& void 0!==e.extensions[this.name].light&&a._addNodeRef(this.cache,e.extensions[this.name].light)}}_loadLight(a){let b=this.parser,c="light:"+a,e=b.cache.get(c);if(e)return e;let f=b.json,g=f.extensions&&f.extensions[this.name]||{},h=g.lights||[],i=h[a],j,k=new d.Ilk(16777215);void 0!==i.color&&k.fromArray(i.color);let l=void 0!==i.range?i.range:0;switch(i.type){case"directional":(j=new d.Ox3(k)).target.position.set(0,0,-1),j.add(j.target);break;case"point":(j=new d.cek(k)).distance=l;break;case"spot":(j=new d.PMe(k)).distance=l,i.spot=i.spot||{},i.spot.innerConeAngle=void 0!==i.spot.innerConeAngle?i.spot.innerConeAngle:0,i.spot.outerConeAngle=void 0!==i.spot.outerConeAngle?i.spot.outerConeAngle:Math.PI/4,j.angle=i.spot.outerConeAngle,j.penumbra=1-i.spot.innerConeAngle/i.spot.outerConeAngle,j.target.position.set(0,0,-1),j.add(j.target);break;default:throw Error("THREE.GLTFLoader: Unexpected light type: "+i.type)}return j.position.set(0,0,0),j.decay=2,void 0!==i.intensity&&(j.intensity=i.intensity),j.name=b.createUniqueName(i.name||"light_"+a),e=Promise.resolve(j),b.cache.add(c,e),e}createNodeAttachment(a){let b=this,c=this.parser,d=c.json,e=d.nodes[a],f=e.extensions&&e.extensions[this.name]||{},g=f.light;return void 0===g?null:this._loadLight(g).then(function(a){return c._getNodeRef(b.cache,g,a)})}}class h{constructor(){this.name=f.KHR_MATERIALS_UNLIT}getMaterialType(){return d.vBJ}extendParams(a,b,c){let e=[];a.color=new d.Ilk(1,1,1),a.opacity=1;let f=b.pbrMetallicRoughness;if(f){if(Array.isArray(f.baseColorFactor)){let g=f.baseColorFactor;a.color.fromArray(g),a.opacity=g[3]}void 0!==f.baseColorTexture&&e.push(c.assignTexture(a,"map",f.baseColorTexture,d.knz))}return Promise.all(e)}}class i{constructor(a){this.parser=a,this.name=f.KHR_MATERIALS_CLEARCOAT}getMaterialType(a){let b=this.parser,c=b.json.materials[a];return c.extensions&&c.extensions[this.name]?d.EJi:null}extendMaterialParams(a,b){let c=this.parser,e=c.json.materials[a];if(!e.extensions||!e.extensions[this.name])return Promise.resolve();let f=[],g=e.extensions[this.name];if(void 0!==g.clearcoatFactor&&(b.clearcoat=g.clearcoatFactor),void 0!==g.clearcoatTexture&&f.push(c.assignTexture(b,"clearcoatMap",g.clearcoatTexture)),void 0!==g.clearcoatRoughnessFactor&&(b.clearcoatRoughness=g.clearcoatRoughnessFactor),void 0!==g.clearcoatRoughnessTexture&&f.push(c.assignTexture(b,"clearcoatRoughnessMap",g.clearcoatRoughnessTexture)),void 0!==g.clearcoatNormalTexture&&(f.push(c.assignTexture(b,"clearcoatNormalMap",g.clearcoatNormalTexture)),void 0!==g.clearcoatNormalTexture.scale)){let h=g.clearcoatNormalTexture.scale;b.clearcoatNormalScale=new d.FM8(h,h)}return Promise.all(f)}}class j{constructor(a){this.parser=a,this.name=f.KHR_MATERIALS_SHEEN}getMaterialType(a){let b=this.parser,c=b.json.materials[a];return c.extensions&&c.extensions[this.name]?d.EJi:null}extendMaterialParams(a,b){let c=this.parser,e=c.json.materials[a];if(!e.extensions||!e.extensions[this.name])return Promise.resolve();let f=[];b.sheenColor=new d.Ilk(0,0,0),b.sheenRoughness=0,b.sheen=1;let g=e.extensions[this.name];return void 0!==g.sheenColorFactor&&b.sheenColor.fromArray(g.sheenColorFactor),void 0!==g.sheenRoughnessFactor&&(b.sheenRoughness=g.sheenRoughnessFactor),void 0!==g.sheenColorTexture&&f.push(c.assignTexture(b,"sheenColorMap",g.sheenColorTexture,d.knz)),void 0!==g.sheenRoughnessTexture&&f.push(c.assignTexture(b,"sheenRoughnessMap",g.sheenRoughnessTexture)),Promise.all(f)}}class k{constructor(a){this.parser=a,this.name=f.KHR_MATERIALS_TRANSMISSION}getMaterialType(a){let b=this.parser,c=b.json.materials[a];return c.extensions&&c.extensions[this.name]?d.EJi:null}extendMaterialParams(a,b){let c=this.parser,d=c.json.materials[a];if(!d.extensions||!d.extensions[this.name])return Promise.resolve();let e=[],f=d.extensions[this.name];return void 0!==f.transmissionFactor&&(b.transmission=f.transmissionFactor),void 0!==f.transmissionTexture&&e.push(c.assignTexture(b,"transmissionMap",f.transmissionTexture)),Promise.all(e)}}class l{constructor(a){this.parser=a,this.name=f.KHR_MATERIALS_VOLUME}getMaterialType(a){let b=this.parser,c=b.json.materials[a];return c.extensions&&c.extensions[this.name]?d.EJi:null}extendMaterialParams(a,b){let c=this.parser,e=c.json.materials[a];if(!e.extensions||!e.extensions[this.name])return Promise.resolve();let f=[],g=e.extensions[this.name];b.thickness=void 0!==g.thicknessFactor?g.thicknessFactor:0,void 0!==g.thicknessTexture&&f.push(c.assignTexture(b,"thicknessMap",g.thicknessTexture)),b.attenuationDistance=g.attenuationDistance||0;let h=g.attenuationColor||[1,1,1];return b.attenuationColor=new d.Ilk(h[0],h[1],h[2]),Promise.all(f)}}class m{constructor(a){this.parser=a,this.name=f.KHR_MATERIALS_IOR}getMaterialType(a){let b=this.parser,c=b.json.materials[a];return c.extensions&&c.extensions[this.name]?d.EJi:null}extendMaterialParams(a,b){let c=this.parser,d=c.json.materials[a];if(!d.extensions||!d.extensions[this.name])return Promise.resolve();let e=d.extensions[this.name];return b.ior=void 0!==e.ior?e.ior:1.5,Promise.resolve()}}class n{constructor(a){this.parser=a,this.name=f.KHR_MATERIALS_SPECULAR}getMaterialType(a){let b=this.parser,c=b.json.materials[a];return c.extensions&&c.extensions[this.name]?d.EJi:null}extendMaterialParams(a,b){let c=this.parser,e=c.json.materials[a];if(!e.extensions||!e.extensions[this.name])return Promise.resolve();let f=[],g=e.extensions[this.name];b.specularIntensity=void 0!==g.specularFactor?g.specularFactor:1,void 0!==g.specularTexture&&f.push(c.assignTexture(b,"specularIntensityMap",g.specularTexture));let h=g.specularColorFactor||[1,1,1];return b.specularColor=new d.Ilk(h[0],h[1],h[2]),void 0!==g.specularColorTexture&&f.push(c.assignTexture(b,"specularColorMap",g.specularColorTexture,d.knz)),Promise.all(f)}}class o{constructor(a){this.parser=a,this.name=f.KHR_TEXTURE_BASISU}loadTexture(a){let b=this.parser,c=b.json,d=c.textures[a];if(!d.extensions||!d.extensions[this.name])return null;let e=d.extensions[this.name],f=b.options.ktx2Loader;if(!f){if(!(c.extensionsRequired&&c.extensionsRequired.indexOf(this.name)>=0))return null;throw Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures")}return b.loadTextureImage(a,e.source,f)}}class p{constructor(a){this.parser=a,this.name=f.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(a){let b=this.name,c=this.parser,d=c.json,e=d.textures[a];if(!e.extensions||!e.extensions[b])return null;let f=e.extensions[b],g=d.images[f.source],h=c.textureLoader;if(g.uri){let i=c.options.manager.getHandler(g.uri);null!==i&&(h=i)}return this.detectSupport().then(function(e){if(e)return c.loadTextureImage(a,f.source,h);if(d.extensionsRequired&&d.extensionsRequired.indexOf(b)>=0)throw Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return c.loadTexture(a)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(a){let b=new Image;b.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",b.onload=b.onerror=function(){a(1===b.height)}})),this.isSupported}}class q{constructor(a){this.name=f.EXT_MESHOPT_COMPRESSION,this.parser=a}loadBufferView(a){let b=this.parser.json,c=b.bufferViews[a];if(!c.extensions||!c.extensions[this.name])return null;{let d=c.extensions[this.name],e=this.parser.getDependency("buffer",d.buffer),f=this.parser.options.meshoptDecoder;if(!f||!f.supported){if(!(b.extensionsRequired&&b.extensionsRequired.indexOf(this.name)>=0))return null;throw Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files")}return Promise.all([e,f.ready]).then(function(a){let b=d.byteOffset||0,c=d.byteLength||0,e=d.count,g=d.byteStride,h=new ArrayBuffer(e*g),i=new Uint8Array(a[0],b,c);return f.decodeGltfBuffer(new Uint8Array(h),e,g,i,d.mode,d.filter),h})}}}let r="glTF",s=12,t={JSON:1313821514,BIN:5130562};class u{constructor(a){this.name=f.KHR_BINARY_GLTF,this.content=null,this.body=null;let b=new DataView(a,0,s);if(this.header={magic:d.Zp0.decodeText(new Uint8Array(a.slice(0,4))),version:b.getUint32(4,!0),length:b.getUint32(8,!0)},this.header.magic!==r)throw Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw Error("THREE.GLTFLoader: Legacy binary file detected.");let c=this.header.length-s,e=new DataView(a,s),g=0;for(;g<c;){let h=e.getUint32(g,!0);g+=4;let i=e.getUint32(g,!0);if(g+=4,i===t.JSON){let j=new Uint8Array(a,s+g,h);this.content=d.Zp0.decodeText(j)}else if(i===t.BIN){let k=s+g;this.body=a.slice(k,k+h)}g+=h}if(null===this.content)throw Error("THREE.GLTFLoader: JSON content not found.")}}class v{constructor(a,b){if(!b)throw Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=f.KHR_DRACO_MESH_COMPRESSION,this.json=a,this.dracoLoader=b,this.dracoLoader.preload()}decodePrimitive(a,b){let c=this.json,d=this.dracoLoader,e=a.extensions[this.name].bufferView,f=a.extensions[this.name].attributes,g={},h={},i={};for(let j in f){let k=I[j]||j.toLowerCase();g[k]=f[j]}for(let l in a.attributes){let m=I[l]||l.toLowerCase();if(void 0!==f[l]){let n=c.accessors[a.attributes[l]],o=E[n.componentType];i[m]=o,h[m]=!0===n.normalized}}return b.getDependency("bufferView",e).then(function(a){return new Promise(function(b){d.decodeDracoFile(a,function(a){for(let c in a.attributes){let d=a.attributes[c],e=h[c];void 0!==e&&(d.normalized=e)}b(a)},g,i)})})}}class w{constructor(){this.name=f.KHR_TEXTURE_TRANSFORM}extendTexture(a,b){return void 0!==b.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===b.offset&& void 0===b.rotation&& void 0===b.scale||(a=a.clone(),void 0!==b.offset&&a.offset.fromArray(b.offset),void 0!==b.rotation&&(a.rotation=b.rotation),void 0!==b.scale&&a.repeat.fromArray(b.scale),a.needsUpdate=!0),a}}class x extends d.Wid{constructor(a){super(),this.isGLTFSpecularGlossinessMaterial=!0;let b={specular:{value:new d.Ilk().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=b,this.onBeforeCompile=function(a){for(let c in b)a.uniforms[c]=b[c];a.fragmentShader=a.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>","#ifdef USE_SPECULARMAP\n	uniform sampler2D specularMap;\n#endif").replace("#include <metalnessmap_pars_fragment>","#ifdef USE_GLOSSINESSMAP\n	uniform sampler2D glossinessMap;\n#endif").replace("#include <roughnessmap_fragment>","vec3 specularFactor = specular;\n#ifdef USE_SPECULARMAP\n	vec4 texelSpecular = texture2D( specularMap, vUv );\n	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture\n	specularFactor *= texelSpecular.rgb;\n#endif").replace("#include <metalnessmap_fragment>","float glossinessFactor = glossiness;\n#ifdef USE_GLOSSINESSMAP\n	vec4 texelGlossiness = texture2D( glossinessMap, vUv );\n	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture\n	glossinessFactor *= texelGlossiness.a;\n#endif").replace("#include <lights_physical_fragment>","PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.\nmaterial.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\nmaterial.specularColor = specularFactor;")},Object.defineProperties(this,{specular:{get:function(){return b.specular.value},set:function(a){b.specular.value=a}},specularMap:{get:function(){return b.specularMap.value},set:function(a){b.specularMap.value=a,a?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return b.glossiness.value},set:function(a){b.glossiness.value=a}},glossinessMap:{get:function(){return b.glossinessMap.value},set:function(a){b.glossinessMap.value=a,a?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(a)}copy(a){return super.copy(a),this.specularMap=a.specularMap,this.specular.copy(a.specular),this.glossinessMap=a.glossinessMap,this.glossiness=a.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class y{constructor(){this.name=f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity"]}getMaterialType(){return x}extendParams(a,b,c){let e=b.extensions[this.name];a.color=new d.Ilk(1,1,1),a.opacity=1;let f=[];if(Array.isArray(e.diffuseFactor)){let g=e.diffuseFactor;a.color.fromArray(g),a.opacity=g[3]}if(void 0!==e.diffuseTexture&&f.push(c.assignTexture(a,"map",e.diffuseTexture,d.knz)),a.emissive=new d.Ilk(0,0,0),a.glossiness=void 0!==e.glossinessFactor?e.glossinessFactor:1,a.specular=new d.Ilk(1,1,1),Array.isArray(e.specularFactor)&&a.specular.fromArray(e.specularFactor),void 0!==e.specularGlossinessTexture){let h=e.specularGlossinessTexture;f.push(c.assignTexture(a,"glossinessMap",h)),f.push(c.assignTexture(a,"specularMap",h,d.knz))}return Promise.all(f)}createMaterial(a){let b=new x(a);return b.fog=!0,b.color=a.color,b.map=void 0===a.map?null:a.map,b.lightMap=null,b.lightMapIntensity=1,b.aoMap=void 0===a.aoMap?null:a.aoMap,b.aoMapIntensity=1,b.emissive=a.emissive,b.emissiveIntensity=1,b.emissiveMap=void 0===a.emissiveMap?null:a.emissiveMap,b.bumpMap=void 0===a.bumpMap?null:a.bumpMap,b.bumpScale=1,b.normalMap=void 0===a.normalMap?null:a.normalMap,b.normalMapType=d.IOt,a.normalScale&&(b.normalScale=a.normalScale),b.displacementMap=null,b.displacementScale=1,b.displacementBias=0,b.specularMap=void 0===a.specularMap?null:a.specularMap,b.specular=a.specular,b.glossinessMap=void 0===a.glossinessMap?null:a.glossinessMap,b.glossiness=a.glossiness,b.alphaMap=null,b.envMap=void 0===a.envMap?null:a.envMap,b.envMapIntensity=1,b}}class z{constructor(){this.name=f.KHR_MESH_QUANTIZATION}}class A extends d._C8{constructor(a,b,c,d){super(a,b,c,d)}copySampleValue_(a){let b=this.resultBuffer,c=this.sampleValues,d=this.valueSize,e=a*d*3+d;for(let f=0;f!==d;f++)b[f]=c[e+f];return b}}A.prototype.beforeStart_=A.prototype.copySampleValue_,A.prototype.afterEnd_=A.prototype.copySampleValue_,A.prototype.interpolate_=function(a,b,c,d){let e=this.resultBuffer,f=this.sampleValues,g=this.valueSize,h=2*g,i=3*g,j=d-b,k=(c-b)/j,l=k*k,m=l*k,n=a*i,o=n-i,p=-2*m+3*l,q=m-l,r=1-p,s=q-l+k;for(let t=0;t!==g;t++){let u=f[o+t+g],v=f[o+t+h]*j,w=f[n+t+g],x=f[n+t]*j;e[t]=r*u+s*v+p*w+q*x}return e};let B=new d._fP;class C extends A{interpolate_(a,b,c,d){let e=super.interpolate_(a,b,c,d);return B.fromArray(e).normalize().toArray(e),e}}let D={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},E={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},F={9728:d.TyD,9729:d.wem,9984:d.YLQ,9985:d.qyh,9986:d.aH4,9987:d.D1R},G={33071:d.uWy,33648:d.OoA,10497:d.rpg},H={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},I={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},J={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},K={CUBICSPLINE:void 0,LINEAR:d.NMF,STEP:d.Syv},L={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function M(a){return void 0===a.DefaultMaterial&&(a.DefaultMaterial=new d.Wid({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:d.Wl3})),a.DefaultMaterial}function N(a,b,c){for(let d in c.extensions)void 0===a[d]&&(b.userData.gltfExtensions=b.userData.gltfExtensions||{},b.userData.gltfExtensions[d]=c.extensions[d])}function O(a,b){void 0!==b.extras&&("object"==typeof b.extras?Object.assign(a.userData,b.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+b.extras))}function P(a,b){if(a.updateMorphTargets(),void 0!==b.weights)for(let c=0,d=b.weights.length;c<d;c++)a.morphTargetInfluences[c]=b.weights[c];if(b.extras&&Array.isArray(b.extras.targetNames)){let e=b.extras.targetNames;if(a.morphTargetInfluences.length===e.length){a.morphTargetDictionary={};for(let f=0,g=e.length;f<g;f++)a.morphTargetDictionary[e[f]]=f}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Q(a){let b=a.extensions&&a.extensions[f.KHR_DRACO_MESH_COMPRESSION],c;return b?"draco:"+b.bufferView+":"+b.indices+":"+R(b.attributes):a.indices+":"+R(a.attributes)+":"+a.mode}function R(a){let b="",c=Object.keys(a).sort();for(let d=0,e=c.length;d<e;d++)b+=c[d]+":"+a[c[d]]+";";return b}function S(a){switch(a){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}class T{constructor(a={},b={}){this.json=a,this.extensions={},this.plugins={},this.options=b,this.cache=new function(){let a={};return{get:function(b){return a[b]},add:function(b,c){a[b]=c},remove:function(b){delete a[b]},removeAll:function(){a={}}}},this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={},"undefined"!=typeof createImageBitmap&& !1===/^((?!chrome|android).)*safari/i.test(navigator.userAgent)?this.textureLoader=new d.QRU(this.options.manager):this.textureLoader=new d.dpR(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new d.hH6(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(a){this.extensions=a}setPlugins(a){this.plugins=a}parse(a,b){let c=this,d=this.json,e=this.extensions;this.cache.removeAll(),this._invokeAll(function(a){return a._markDefs&&a._markDefs()}),Promise.all(this._invokeAll(function(a){return a.beforeRoot&&a.beforeRoot()})).then(function(){return Promise.all([c.getDependencies("scene"),c.getDependencies("animation"),c.getDependencies("camera"),])}).then(function(b){let f={scene:b[0][d.scene||0],scenes:b[0],animations:b[1],cameras:b[2],asset:d.asset,parser:c,userData:{}};N(e,f,d),O(f,d),Promise.all(c._invokeAll(function(a){return a.afterRoot&&a.afterRoot(f)})).then(function(){a(f)})}).catch(b)}_markDefs(){let a=this.json.nodes||[],b=this.json.skins||[],c=this.json.meshes||[];for(let d=0,e=b.length;d<e;d++){let f=b[d].joints;for(let g=0,h=f.length;g<h;g++)a[f[g]].isBone=!0}for(let i=0,j=a.length;i<j;i++){let k=a[i];void 0!==k.mesh&&(this._addNodeRef(this.meshCache,k.mesh),void 0!==k.skin&&(c[k.mesh].isSkinnedMesh=!0)),void 0!==k.camera&&this._addNodeRef(this.cameraCache,k.camera)}}_addNodeRef(a,b){void 0!==b&&(void 0===a.refs[b]&&(a.refs[b]=a.uses[b]=0),a.refs[b]++)}_getNodeRef(a,b,c){if(a.refs[b]<=1)return c;let d=c.clone(),e=(a,b)=>{let c=this.associations.get(a);for(let[d,f]of(null!=c&&this.associations.set(b,c),a.children.entries()))e(f,b.children[d])};return e(c,d),d.name+="_instance_"+a.uses[b]++,d}_invokeOne(a){let b=Object.values(this.plugins);b.push(this);for(let c=0;c<b.length;c++){let d=a(b[c]);if(d)return d}return null}_invokeAll(a){let b=Object.values(this.plugins);b.unshift(this);let c=[];for(let d=0;d<b.length;d++){let e=a(b[d]);e&&c.push(e)}return c}getDependency(a,b){let c=a+":"+b,d=this.cache.get(c);if(!d){switch(a){case"scene":d=this.loadScene(b);break;case"node":d=this.loadNode(b);break;case"mesh":d=this._invokeOne(function(a){return a.loadMesh&&a.loadMesh(b)});break;case"accessor":d=this.loadAccessor(b);break;case"bufferView":d=this._invokeOne(function(a){return a.loadBufferView&&a.loadBufferView(b)});break;case"buffer":d=this.loadBuffer(b);break;case"material":d=this._invokeOne(function(a){return a.loadMaterial&&a.loadMaterial(b)});break;case"texture":d=this._invokeOne(function(a){return a.loadTexture&&a.loadTexture(b)});break;case"skin":d=this.loadSkin(b);break;case"animation":d=this.loadAnimation(b);break;case"camera":d=this.loadCamera(b);break;default:throw Error("Unknown type: "+a)}this.cache.add(c,d)}return d}getDependencies(a){let b=this.cache.get(a);if(!b){let c=this,d=this.json[a+("mesh"===a?"es":"s")]||[];b=Promise.all(d.map(function(b,d){return c.getDependency(a,d)})),this.cache.add(a,b)}return b}loadBuffer(a){let b=this.json.buffers[a],c=this.fileLoader;if(b.type&&"arraybuffer"!==b.type)throw Error("THREE.GLTFLoader: "+b.type+" buffer type is not supported.");if(void 0===b.uri&&0===a)return Promise.resolve(this.extensions[f.KHR_BINARY_GLTF].body);let e=this.options;return new Promise(function(a,f){c.load(d.Zp0.resolveURL(b.uri,e.path),a,void 0,function(){f(Error('THREE.GLTFLoader: Failed to load buffer "'+b.uri+'".'))})})}loadBufferView(a){let b=this.json.bufferViews[a];return this.getDependency("buffer",b.buffer).then(function(a){let c=b.byteLength||0,d=b.byteOffset||0;return a.slice(d,d+c)})}loadAccessor(a){let b=this,c=this.json,e=this.json.accessors[a];if(void 0===e.bufferView&& void 0===e.sparse)return Promise.resolve(null);let f=[];return void 0!==e.bufferView?f.push(this.getDependency("bufferView",e.bufferView)):f.push(null),void 0!==e.sparse&&(f.push(this.getDependency("bufferView",e.sparse.indices.bufferView)),f.push(this.getDependency("bufferView",e.sparse.values.bufferView))),Promise.all(f).then(function(a){let f=a[0],g=H[e.type],h=E[e.componentType],i=h.BYTES_PER_ELEMENT,j=e.byteOffset||0,k=void 0!==e.bufferView?c.bufferViews[e.bufferView].byteStride:void 0,l=!0===e.normalized,m,n;if(k&&k!==i*g){let o=Math.floor(j/k),p="InterleavedBuffer:"+e.bufferView+":"+e.componentType+":"+o+":"+e.count,q=b.cache.get(p);q||(m=new h(f,o*k,e.count*k/i),q=new d.vpT(m,k/i),b.cache.add(p,q)),n=new d.kB5(q,g,j%k/i,l)}else m=null===f?new h(e.count*g):new h(f,j,e.count*g),n=new d.TlE(m,g,l);if(void 0!==e.sparse){let r=H.SCALAR,s=E[e.sparse.indices.componentType],t=e.sparse.indices.byteOffset||0,u=e.sparse.values.byteOffset||0,v=new s(a[1],t,e.sparse.count*r),w=new h(a[2],u,e.sparse.count*g);null!==f&&(n=new d.TlE(n.array.slice(),n.itemSize,n.normalized));for(let x=0,y=v.length;x<y;x++){let z=v[x];if(n.setX(z,w[x*g]),g>=2&&n.setY(z,w[x*g+1]),g>=3&&n.setZ(z,w[x*g+2]),g>=4&&n.setW(z,w[x*g+3]),g>=5)throw Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return n})}loadTexture(a){let b=this.json,c=this.options,d=b.textures[a],e=d.source,f=b.images[e],g=this.textureLoader;if(f.uri){let h=c.manager.getHandler(f.uri);null!==h&&(g=h)}return this.loadTextureImage(a,e,g)}loadTextureImage(a,b,c){let e=this,f=this.json,g=f.textures[a],h=f.images[b],i=(h.uri||h.bufferView)+":"+g.sampler;if(this.textureCache[i])return this.textureCache[i];let j=this.loadImageSource(b,c).then(function(b){b.flipY=!1,g.name&&(b.name=g.name);let c=f.samplers||{},h=c[g.sampler]||{};return b.magFilter=F[h.magFilter]||d.wem,b.minFilter=F[h.minFilter]||d.D1R,b.wrapS=G[h.wrapS]||d.rpg,b.wrapT=G[h.wrapT]||d.rpg,e.associations.set(b,{textures:a}),b}).catch(function(){return null});return this.textureCache[i]=j,j}loadImageSource(a,b){let c=this.json,e=this.options;if(void 0!==this.sourceCache[a])return this.sourceCache[a].then(a=>a.clone());let f=c.images[a],g=self.URL||self.webkitURL,h=f.uri||"",i=!1;if(void 0!==f.bufferView)h=this.getDependency("bufferView",f.bufferView).then(function(a){i=!0;let b=new Blob([a],{type:f.mimeType});return h=g.createObjectURL(b)});else if(void 0===f.uri)throw Error("THREE.GLTFLoader: Image "+a+" is missing URI and bufferView");let j=Promise.resolve(h).then(function(a){return new Promise(function(c,f){let g=c;!0===b.isImageBitmapLoader&&(g=function(a){let b=new d.xEZ(a);b.needsUpdate=!0,c(b)}),b.load(d.Zp0.resolveURL(a,e.path),g,void 0,f)})}).then(function(a){var b;return!0===i&&g.revokeObjectURL(h),a.userData.mimeType=f.mimeType||((b=f.uri).search(/\.jpe?g($|\?)/i)>0||0===b.search(/^data\:image\/jpeg/)?"image/jpeg":b.search(/\.webp($|\?)/i)>0||0===b.search(/^data\:image\/webp/)?"image/webp":"image/png"),a}).catch(function(a){throw console.error("THREE.GLTFLoader: Couldn't load texture",h),a});return this.sourceCache[a]=j,j}assignTexture(a,b,c,d){let e=this;return this.getDependency("texture",c.index).then(function(g){if(void 0===c.texCoord||0==c.texCoord||"aoMap"===b&&1==c.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+c.texCoord+" for texture "+b+" not yet supported."),e.extensions[f.KHR_TEXTURE_TRANSFORM]){let h=void 0!==c.extensions?c.extensions[f.KHR_TEXTURE_TRANSFORM]:void 0;if(h){let i=e.associations.get(g);g=e.extensions[f.KHR_TEXTURE_TRANSFORM].extendTexture(g,h),e.associations.set(g,i)}}return void 0!==d&&(g.encoding=d),a[b]=g,g})}assignFinalMaterial(a){let b=a.geometry,c=a.material,e=void 0===b.attributes.tangent,f=void 0!==b.attributes.color,g=void 0===b.attributes.normal;if(a.isPoints){let h="PointsMaterial:"+c.uuid,i=this.cache.get(h);i||(i=new d.UY4,d.F5T.prototype.copy.call(i,c),i.color.copy(c.color),i.map=c.map,i.sizeAttenuation=!1,this.cache.add(h,i)),c=i}else if(a.isLine){let j="LineBasicMaterial:"+c.uuid,k=this.cache.get(j);k||(k=new d.nls,d.F5T.prototype.copy.call(k,c),k.color.copy(c.color),this.cache.add(j,k)),c=k}if(e||f||g){let l="ClonedMaterial:"+c.uuid+":";c.isGLTFSpecularGlossinessMaterial&&(l+="specular-glossiness:"),e&&(l+="derivative-tangents:"),f&&(l+="vertex-colors:"),g&&(l+="flat-shading:");let m=this.cache.get(l);m||(m=c.clone(),f&&(m.vertexColors=!0),g&&(m.flatShading=!0),e&&(m.normalScale&&(m.normalScale.y*=-1),m.clearcoatNormalScale&&(m.clearcoatNormalScale.y*=-1)),this.cache.add(l,m),this.associations.set(m,this.associations.get(c))),c=m}c.aoMap&& void 0===b.attributes.uv2&& void 0!==b.attributes.uv&&b.setAttribute("uv2",b.attributes.uv),a.material=c}getMaterialType(){return d.Wid}loadMaterial(a){let b=this,c=this.json,e=this.extensions,g=c.materials[a],h,i={},j=g.extensions||{},k=[];if(j[f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){let l=e[f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];h=l.getMaterialType(),k.push(l.extendParams(i,g,b))}else if(j[f.KHR_MATERIALS_UNLIT]){let m=e[f.KHR_MATERIALS_UNLIT];h=m.getMaterialType(),k.push(m.extendParams(i,g,b))}else{let n=g.pbrMetallicRoughness||{};if(i.color=new d.Ilk(1,1,1),i.opacity=1,Array.isArray(n.baseColorFactor)){let o=n.baseColorFactor;i.color.fromArray(o),i.opacity=o[3]}void 0!==n.baseColorTexture&&k.push(b.assignTexture(i,"map",n.baseColorTexture,d.knz)),i.metalness=void 0!==n.metallicFactor?n.metallicFactor:1,i.roughness=void 0!==n.roughnessFactor?n.roughnessFactor:1,void 0!==n.metallicRoughnessTexture&&(k.push(b.assignTexture(i,"metalnessMap",n.metallicRoughnessTexture)),k.push(b.assignTexture(i,"roughnessMap",n.metallicRoughnessTexture))),h=this._invokeOne(function(b){return b.getMaterialType&&b.getMaterialType(a)}),k.push(Promise.all(this._invokeAll(function(b){return b.extendMaterialParams&&b.extendMaterialParams(a,i)})))}!0===g.doubleSided&&(i.side=d.ehD);let p=g.alphaMode||L.OPAQUE;if(p===L.BLEND?(i.transparent=!0,i.depthWrite=!1):(i.transparent=!1,p===L.MASK&&(i.alphaTest=void 0!==g.alphaCutoff?g.alphaCutoff:.5)),void 0!==g.normalTexture&&h!==d.vBJ&&(k.push(b.assignTexture(i,"normalMap",g.normalTexture)),i.normalScale=new d.FM8(1,1),void 0!==g.normalTexture.scale)){let q=g.normalTexture.scale;i.normalScale.set(q,q)}return void 0!==g.occlusionTexture&&h!==d.vBJ&&(k.push(b.assignTexture(i,"aoMap",g.occlusionTexture)),void 0!==g.occlusionTexture.strength&&(i.aoMapIntensity=g.occlusionTexture.strength)),void 0!==g.emissiveFactor&&h!==d.vBJ&&(i.emissive=new d.Ilk().fromArray(g.emissiveFactor)),void 0!==g.emissiveTexture&&h!==d.vBJ&&k.push(b.assignTexture(i,"emissiveMap",g.emissiveTexture,d.knz)),Promise.all(k).then(function(){let c;return c=h===x?e[f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(i):new h(i),g.name&&(c.name=g.name),O(c,g),b.associations.set(c,{materials:a}),g.extensions&&N(e,c,g),c})}createUniqueName(a){let b=d.iUV.sanitizeNodeName(a||""),c=b;for(let e=1;this.nodeNamesUsed[c];++e)c=b+"_"+e;return this.nodeNamesUsed[c]=!0,c}loadGeometries(a){let b=this,c=this.extensions,e=this.primitiveCache;function g(a){return c[f.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,b).then(function(c){return V(c,a,b)})}let h=[];for(let i=0,j=a.length;i<j;i++){let k=a[i],l=Q(k),m=e[l];if(m)h.push(m.promise);else{let n;n=k.extensions&&k.extensions[f.KHR_DRACO_MESH_COMPRESSION]?g(k):V(new d.u9r,k,b),e[l]={primitive:k,promise:n},h.push(n)}}return Promise.all(h)}loadMesh(a){let b=this,c=this.json,e=this.extensions,f=c.meshes[a],g=f.primitives,h=[];for(let i=0,j=g.length;i<j;i++){let k=void 0===g[i].material?M(this.cache):this.getDependency("material",g[i].material);h.push(k)}return h.push(b.loadGeometries(g)),Promise.all(h).then(function(c){let h=c.slice(0,c.length-1),i=c[c.length-1],j=[];for(let k=0,l=i.length;k<l;k++){let m=i[k],n=g[k],o,p=h[k];if(n.mode===D.TRIANGLES||n.mode===D.TRIANGLE_STRIP||n.mode===D.TRIANGLE_FAN|| void 0===n.mode)!0!==(o=!0===f.isSkinnedMesh?new d.TUv(m,p):new d.Kj0(m,p)).isSkinnedMesh||o.geometry.attributes.skinWeight.normalized||o.normalizeSkinWeights(),n.mode===D.TRIANGLE_STRIP?o.geometry=W(o.geometry,d.UlW):n.mode===D.TRIANGLE_FAN&&(o.geometry=W(o.geometry,d.z$h));else if(n.mode===D.LINES)o=new d.ejS(m,p);else if(n.mode===D.LINE_STRIP)o=new d.x12(m,p);else if(n.mode===D.LINE_LOOP)o=new d.blk(m,p);else if(n.mode===D.POINTS)o=new d.woe(m,p);else throw Error("THREE.GLTFLoader: Primitive mode unsupported: "+n.mode);Object.keys(o.geometry.morphAttributes).length>0&&P(o,f),o.name=b.createUniqueName(f.name||"mesh_"+a),O(o,f),n.extensions&&N(e,o,n),b.assignFinalMaterial(o),j.push(o)}for(let q=0,r=j.length;q<r;q++)b.associations.set(j[q],{meshes:a,primitives:q});if(1===j.length)return j[0];let s=new d.ZAu;b.associations.set(s,{meshes:a});for(let t=0,u=j.length;t<u;t++)s.add(j[t]);return s})}loadCamera(a){let b,c=this.json.cameras[a],e=c[c.type];if(!e){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return"perspective"===c.type?b=new d.cPb(d.M8C.radToDeg(e.yfov),e.aspectRatio||1,e.znear||1,e.zfar||2e6):"orthographic"===c.type&&(b=new d.iKG(-e.xmag,e.xmag,e.ymag,-e.ymag,e.znear,e.zfar)),c.name&&(b.name=this.createUniqueName(c.name)),O(b,c),Promise.resolve(b)}loadSkin(a){let b=this.json.skins[a],c={joints:b.joints};return void 0===b.inverseBindMatrices?Promise.resolve(c):this.getDependency("accessor",b.inverseBindMatrices).then(function(a){return c.inverseBindMatrices=a,c})}loadAnimation(a){let b=this.json,c=b.animations[a],e=[],f=[],g=[],h=[],i=[];for(let j=0,k=c.channels.length;j<k;j++){let l=c.channels[j],m=c.samplers[l.sampler],n=l.target,o=void 0!==n.node?n.node:n.id,p=void 0!==c.parameters?c.parameters[m.input]:m.input,q=void 0!==c.parameters?c.parameters[m.output]:m.output;e.push(this.getDependency("node",o)),f.push(this.getDependency("accessor",p)),g.push(this.getDependency("accessor",q)),h.push(m),i.push(n)}return Promise.all([Promise.all(e),Promise.all(f),Promise.all(g),Promise.all(h),Promise.all(i)]).then(function(b){let e=b[0],f=b[1],g=b[2],h=b[3],i=b[4],j=[];for(let k=0,l=e.length;k<l;k++){let m=e[k],n=f[k],o=g[k],p=h[k],q=i[k];if(void 0===m)continue;m.updateMatrix(),m.matrixAutoUpdate=!0;let r;switch(J[q.path]){case J.weights:r=d.dUE;break;case J.rotation:r=d.iLg;break;case J.position:case J.scale:default:r=d.yC1}let s=m.name?m.name:m.uuid,t=void 0!==p.interpolation?K[p.interpolation]:d.NMF,u=[];J[q.path]===J.weights?m.traverse(function(a){a.morphTargetInfluences&&u.push(a.name?a.name:a.uuid)}):u.push(s);let v=o.array;if(o.normalized){let w=S(v.constructor),x=new Float32Array(v.length);for(let y=0,z=v.length;y<z;y++)x[y]=v[y]*w;v=x}for(let B=0,D=u.length;B<D;B++){let E=new r(u[B]+"."+J[q.path],n.array,v,t);"CUBICSPLINE"===p.interpolation&&(E.createInterpolant=function(a){let b=this instanceof d.iLg?C:A;return new b(this.times,this.values,this.getValueSize()/3,a)},E.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),j.push(E)}}let F=c.name?c.name:"animation_"+a;return new d.m7l(F,void 0,j)})}createNodeMesh(a){let b=this.json,c=this,d=b.nodes[a];return void 0===d.mesh?null:c.getDependency("mesh",d.mesh).then(function(a){let b=c._getNodeRef(c.meshCache,d.mesh,a);return void 0!==d.weights&&b.traverse(function(a){if(a.isMesh)for(let b=0,c=d.weights.length;b<c;b++)a.morphTargetInfluences[b]=d.weights[b]}),b})}loadNode(a){let b=this.json,c=this.extensions,e=this,f=b.nodes[a],g=f.name?e.createUniqueName(f.name):"";return(function(){let b=[],c=e._invokeOne(function(b){return b.createNodeMesh&&b.createNodeMesh(a)});return c&&b.push(c),void 0!==f.camera&&b.push(e.getDependency("camera",f.camera).then(function(a){return e._getNodeRef(e.cameraCache,f.camera,a)})),e._invokeAll(function(b){return b.createNodeAttachment&&b.createNodeAttachment(a)}).forEach(function(a){b.push(a)}),Promise.all(b)})().then(function(b){let h;if((h=!0===f.isBone?new d.N$j:b.length>1?new d.ZAu:1===b.length?b[0]:new d.Tme)!==b[0])for(let i=0,j=b.length;i<j;i++)h.add(b[i]);if(f.name&&(h.userData.name=f.name,h.name=g),O(h,f),f.extensions&&N(c,h,f),void 0!==f.matrix){let k=new d.yGw;k.fromArray(f.matrix),h.applyMatrix4(k)}else void 0!==f.translation&&h.position.fromArray(f.translation),void 0!==f.rotation&&h.quaternion.fromArray(f.rotation),void 0!==f.scale&&h.scale.fromArray(f.scale);return e.associations.has(h)||e.associations.set(h,{}),e.associations.get(h).nodes=a,h})}loadScene(a){let b=this.json,c=this.extensions,e=this.json.scenes[a],f=this,g=new d.ZAu;e.name&&(g.name=f.createUniqueName(e.name)),O(g,e),e.extensions&&N(c,g,e);let h=e.nodes||[],i=[];for(let j=0,k=h.length;j<k;j++)i.push(U(h[j],g,b,f));return Promise.all(i).then(function(){return f.associations=(a=>{let b=new Map;for(let[c,e]of f.associations)(c instanceof d.F5T||c instanceof d.xEZ)&&b.set(c,e);return a.traverse(a=>{let c=f.associations.get(a);null!=c&&b.set(a,c)}),b})(g),g})}}function U(a,b,c,e){let f=c.nodes[a];return e.getDependency("node",a).then(function(a){if(void 0===f.skin)return a;let b;return e.getDependency("skin",f.skin).then(function(a){b=a;let c=[];for(let d=0,f=b.joints.length;d<f;d++)c.push(e.getDependency("node",b.joints[d]));return Promise.all(c)}).then(function(c){return a.traverse(function(a){if(!a.isMesh)return;let e=[],f=[];for(let g=0,h=c.length;g<h;g++){let i=c[g];if(i){e.push(i);let j=new d.yGw;void 0!==b.inverseBindMatrices&&j.fromArray(b.inverseBindMatrices.array,16*g),f.push(j)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',b.joints[g])}a.bind(new d.OdW(e,f),a.matrixWorld)}),a})}).then(function(a){b.add(a);let d=[];if(f.children){let g=f.children;for(let h=0,i=g.length;h<i;h++){let j=g[h];d.push(U(j,a,c,e))}}return Promise.all(d)})}function V(a,b,c){let e=b.attributes,f=[];function g(b,d){return c.getDependency("accessor",b).then(function(b){a.setAttribute(d,b)})}for(let h in e){let i=I[h]||h.toLowerCase();i in a.attributes||f.push(g(e[h],i))}if(void 0!==b.indices&&!a.index){let j=c.getDependency("accessor",b.indices).then(function(b){a.setIndex(b)});f.push(j)}return O(a,b),!function(a,b,c){let e=b.attributes,f=new d.ZzF;if(void 0===e.POSITION)return;{let g=c.json.accessors[e.POSITION],h=g.min,i=g.max;if(void 0!==h&& void 0!==i){if(f.set(new d.Pa4(h[0],h[1],h[2]),new d.Pa4(i[0],i[1],i[2])),g.normalized){let j=S(E[g.componentType]);f.min.multiplyScalar(j),f.max.multiplyScalar(j)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}let k=b.targets;if(void 0!==k){let l=new d.Pa4,m=new d.Pa4;for(let n=0,o=k.length;n<o;n++){let p=k[n];if(void 0!==p.POSITION){let q=c.json.accessors[p.POSITION],r=q.min,s=q.max;if(void 0!==r&& void 0!==s){if(m.setX(Math.max(Math.abs(r[0]),Math.abs(s[0]))),m.setY(Math.max(Math.abs(r[1]),Math.abs(s[1]))),m.setZ(Math.max(Math.abs(r[2]),Math.abs(s[2]))),q.normalized){let t=S(E[q.componentType]);m.multiplyScalar(t)}l.max(m)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}f.expandByVector(l)}a.boundingBox=f;let u=new d.aLr;f.getCenter(u.center),u.radius=f.min.distanceTo(f.max)/2,a.boundingSphere=u}(a,b,c),Promise.all(f).then(function(){return void 0!==b.targets?function(a,b,c){let d=!1,e=!1,f=!1;for(let g=0,h=b.length;g<h;g++){let i=b[g];if(void 0!==i.POSITION&&(d=!0),void 0!==i.NORMAL&&(e=!0),void 0!==i.COLOR_0&&(f=!0),d&&e&&f)break}if(!d&&!e&&!f)return Promise.resolve(a);let j=[],k=[],l=[];for(let m=0,n=b.length;m<n;m++){let o=b[m];if(d){let p=void 0!==o.POSITION?c.getDependency("accessor",o.POSITION):a.attributes.position;j.push(p)}if(e){let q=void 0!==o.NORMAL?c.getDependency("accessor",o.NORMAL):a.attributes.normal;k.push(q)}if(f){let r=void 0!==o.COLOR_0?c.getDependency("accessor",o.COLOR_0):a.attributes.color;l.push(r)}}return Promise.all([Promise.all(j),Promise.all(k),Promise.all(l)]).then(function(b){let c=b[0],g=b[1],h=b[2];return d&&(a.morphAttributes.position=c),e&&(a.morphAttributes.normal=g),f&&(a.morphAttributes.color=h),a.morphTargetsRelative=!0,a})}(a,b.targets,c):a})}function W(a,b){let c=a.getIndex();if(null===c){let e=[],f=a.getAttribute("position");if(void 0===f)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),a;for(let g=0;g<f.count;g++)e.push(g);a.setIndex(e),c=a.getIndex()}let h=c.count-2,i=[];if(b===d.z$h)for(let j=1;j<=h;j++)i.push(c.getX(0)),i.push(c.getX(j)),i.push(c.getX(j+1));else for(let k=0;k<h;k++)k%2==0?(i.push(c.getX(k)),i.push(c.getX(k+1)),i.push(c.getX(k+2))):(i.push(c.getX(k+2)),i.push(c.getX(k+1)),i.push(c.getX(k)));i.length/3!==h&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let l=a.clone();return l.setIndex(i),l}}}])